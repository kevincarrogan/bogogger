{% extends 'base.html' %}

{% block content %}
<h1>{{ game.name }}</h1>

<nav>
    <ul>
        <li>
            <a href="{% url 'game_play_create_from_game' slug=game.slug %}">
                Log Play
            </a>
        </li>
        <li>
            <a href="{% url 'game_update' slug=game.slug %}">Edit</a>
        </li>
    </ul>
</nav>

<dl>
    <dt>Players</dt>
    <dd>
        {% if game.min_players == game.max_players %}
            {{ game.min_players }}
        {% else %}
            {{ game.min_players }} - {{ game.max_players }}
        {% endif %}
    </dd>
</dl>

<section>
    <h1>Leaderboard</h1>
    <table class="{% if not ratings %}empty-table{% endif %}">
        <thead>
            <tr>
                <th>Name</th>
                <th>Rating</th>
            </tr>
        </thead>
        <tbody>
            {% for rating in ratings %}
            <tr>
                <td>
                    <a href="{% url 'player_detail' slug=rating.player.slug %}">{{ rating.player }}</a>
                </td>
                <td>
                    {{ rating.rating.rating }}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="1000">
                    <em>There have been no plays of {{ game }}. Do you want to <a href="{% url 'game_play_create_from_game' slug=game.slug %}">log on</a>?</em>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</section>

<h2>Recent Plays</h2>

{% if recent_plays %}
    <ol>
    {% for recent_play in recent_plays %}
        <li>
            {% for player in recent_play.players.all %}
            <a href="{% url 'player_detail' slug=player.slug %}">{{ player }}</a>
            {% if not forloop.last %}
            vs.
            {% endif %}
            {% endfor %}
        </li>
    {% endfor %}
    </ol>
{% else %}
    <p><em>There haven't been any plays of {{ game }}</em></p>
{% endif %}

{% endblock %}
